constants = {
	my_modifier = 9;
};

enums = {
	namespaces: ["stdin", "clickpad"];
};

predicates = {
	is_evdev = {
		type = "code_ns";
		min = "namespaces.clickpad";
		max = "namespaces.clickpad";
	};
	key_event = {
		type = "and";
		args = (
			"is_evdev",
			{
				type = "code_major";
				min = "event_type.KEY";
				max = "event_type.KEY";
			}
		);
	};
};

nodes = {
	stdin = {
		type = "getchar";
		options = {
			namespace = "namespaces.stdin";
		};
	};
	print = {
		type = "print";
		options = {};
	};
	clickpad = {
		type = "evdev";
		options = {
			file = "/dev/input/event7";
			namespace = "namespaces.clickpad";
		};
	};
	select_key_events = {
		type = "router";
		options = {
			predicates = (
				"key_event",
				{
					type = "or";
					inverted = 1;
					args = ["key_event"];
				}
			);
		};
	};
	set_modifier = {
		type = "modifiers";
		options = {
			operation = "set";
			modifiers = ["my_modifier"];
		};
	};
};

channels = ({
	from: ("stdin", 0);
	to: ("select_key_events", 0);
}, {
	from: ("clickpad", 0);
	to: ("select_key_events", 1);
}, {
	from: ("select_key_events", 0);
	to: ("set_modifier", 0);
}, {
	from: ("set_modifier", 0);
	to: ("print", 0);
}, {
	from: ("select_key_events", 1);
	to: ("print", 1);
});

// vim: ft=libconfig
